// Daily Challenge System
// Auto-generated by Daily Leaderboard workflow

module.exports = {
  getChallenge: function() {
    const today = new Date().toISOString().split('T')[0];
    
    if (!Memory.dailyChallenge || Memory.dailyChallenge.date !== today) {
      const challenges = [
        { emoji: 'ðŸš€', name: 'Speed Demon', desc: 'Move 500 tiles', metric: 'moves', target: 500 },
        { emoji: 'â›ï¸', name: 'Mining Master', desc: 'Harvest 5000 energy', metric: 'harvested', target: 5000 },
        { emoji: 'ðŸ­', name: 'Architect', desc: 'Build 10 structures', metric: 'built', target: 10 },
        { emoji: 'ðŸ”§', name: 'Repairman', desc: 'Repair 3000 HP', metric: 'repaired', target: 3000 },
        { emoji: 'ðŸŒŸ', name: 'Controller King', desc: 'Upgrade 50 times', metric: 'upgrades', target: 50 }
      ];
      
      const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
      const challenge = challenges[dayOfYear % challenges.length];
      
      Memory.dailyChallenge = {
        date: today,
        challenge: challenge,
        progress: 0,
        completed: false
      };
    }
    
    return Memory.dailyChallenge;
  },
  
  updateProgress: function(metric, amount) {
    const challenge = this.getChallenge();
    
    if (challenge.challenge.metric === metric && !challenge.completed) {
      challenge.progress += amount;
      
      if (challenge.progress >= challenge.challenge.target) {
        challenge.completed = true;
        console.log(`ðŸŽ‰ CHALLENGE COMPLETE! ${challenge.challenge.emoji} ${challenge.challenge.name}`);
      }
    }
  },
  
  displayChallenge: function() {
    const challenge = this.getChallenge();
    const c = challenge.challenge;
    const percent = Math.min(100, Math.floor((challenge.progress / c.target) * 100));
    
    console.log(`\nðŸŽ¯ TODAY'S CHALLENGE: ${c.emoji} ${c.name}`);
    console.log(`   ${c.desc}`);
    console.log(`   Progress: ${challenge.progress}/${c.target} (${percent}%)`);
    
    if (challenge.completed) {
      console.log(`   âœ… COMPLETED!`);
    }
  }
};
